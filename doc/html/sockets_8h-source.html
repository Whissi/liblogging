<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>liblogging: sockets.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>sockets.h</h1><a href="sockets_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00050 <span class="preprocessor">#ifndef __LIB3195_SOCKETS_H_INCLUDED__</span>
00051 <span class="preprocessor"></span><span class="preprocessor">#define __LIB3195_SOCKETS_H_INCLUDED__ 1</span>
00052 <span class="preprocessor"></span>
00053 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00054 <span class="preprocessor">#ifdef SROS_WIN32</span>
00055 <span class="preprocessor"></span><span class="preprocessor">#  include &lt;winsock2.h&gt;</span>
00056 <span class="preprocessor">#else</span>
00057 <span class="preprocessor"></span><span class="preprocessor">#include &lt;sys/types.h&gt;</span>
00058 <span class="preprocessor">#include &lt;sys/time.h&gt;</span>
00059 <span class="preprocessor">#include &lt;sys/socket.h&gt;</span>
00060 <span class="preprocessor">#include &lt;sys/select.h&gt;</span>
00061 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
00062 <span class="preprocessor">#include &lt;netinet/in.h&gt;</span>
00063 <span class="preprocessor">#include &lt;netdb.h&gt;</span>
00064 <span class="preprocessor">#include &lt;errno.h&gt;</span>
00065 <span class="preprocessor">#endif</span>
00066 <span class="preprocessor"></span>
00067 <span class="preprocessor">#define sbSockCHECKVALIDOBJECT(x) {assert(x != NULL); assert(x-&gt;OID == OIDsbSock);}</span>
00068 <span class="preprocessor"></span>
<a name="l00072"></a><a class="code" href="sockets_8h.html#a2">00072</a> <span class="preprocessor">#define sbSOCK_NO_CHAR -1</span>
00073 <span class="preprocessor"></span>
<a name="l00074"></a><a class="code" href="structsbSockObject.html">00074</a> <span class="keyword">struct </span><a class="code" href="structsbSockObject.html">sbSockObject</a> 
00078 {       
<a name="l00079"></a><a class="code" href="structsbSockObject.html#o0">00079</a>         srObjID <a class="code" href="structsbSockObject.html#o0">OID</a>;            
<a name="l00080"></a><a class="code" href="structsbSockObject.html#o1">00080</a>         <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="structsbSockObject.html#o1">iLastErr</a>;  
<a name="l00081"></a><a class="code" href="structsbSockObject.html#o2">00081</a>         SR_SOCKET <a class="code" href="structsbSockObject.html#o2">sock</a>;         
<a name="l00082"></a><a class="code" href="structsbSockObject.html#o3">00082</a>         <span class="keywordtype">int</span> <a class="code" href="structsbSockObject.html#o3">bIsInError</a>;         
<a name="l00083"></a><a class="code" href="structsbSockObject.html#o4">00083</a>         <span class="keywordtype">int</span>     <a class="code" href="structsbSockObject.html#o4">dwLastError</a>;    
<a name="l00084"></a><a class="code" href="structsbSockObject.html#o5">00084</a>         <span class="keywordtype">char</span> <a class="code" href="structsbSockObject.html#o5">szInBuf</a>[<a class="code" href="config_8h.html#a3">SOCKETMAXINBUFSIZE</a>]; 
<a name="l00085"></a><a class="code" href="structsbSockObject.html#o6">00085</a>         <span class="keywordtype">int</span> <a class="code" href="structsbSockObject.html#o6">iCurInBufPos</a>;       
<a name="l00086"></a><a class="code" href="structsbSockObject.html#o7">00086</a>         <span class="keywordtype">int</span> <a class="code" href="structsbSockObject.html#o7">iInBufLen</a>;          
<a name="l00087"></a><a class="code" href="structsbSockObject.html#o8">00087</a>         fd_set <a class="code" href="structsbSockObject.html#o8">fdset</a>;           
00088 <span class="preprocessor">#       if FEATURE_LISTENER == 1</span>
<a name="l00089"></a><a class="code" href="structsbSockObject.html#o9">00089</a> <span class="preprocessor"></span>        <span class="keyword">struct </span>sockaddr_in RemoteHostAddr;
<a name="l00090"></a><a class="code" href="structsbSockObject.html#o10">00090</a>         <span class="keywordtype">char</span> *<a class="code" href="structsbSockObject.html#o10">pRemoteHostIP</a>;    
<a name="l00091"></a><a class="code" href="structsbSockObject.html#o11">00091</a>         <span class="keywordtype">int</span> <a class="code" href="structsbSockObject.html#o11">iRemHostIPBufLen</a>;   
00092 <span class="preprocessor">#       endif</span>
00093 <span class="preprocessor"></span>};
00094 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsbSockObject.html">sbSockObject</a> sbSockObj;
00095 
00096 
00097 <span class="comment">/* The following three macros could also be inline code.</span>
00098 <span class="comment"> * For now, I have kept them to be macros to make </span>
00099 <span class="comment"> * facilitate porting.</span>
00100 <span class="comment"> */</span>
00101 
<a name="l00103"></a><a class="code" href="sockets_8h.html#a3">00103</a> <span class="preprocessor">#define sbSockGetLastError(pThis) pThis-&gt;iLastErr</span>
00104 <span class="preprocessor"></span>
<a name="l00106"></a><a class="code" href="sockets_8h.html#a4">00106</a> <span class="preprocessor">#define sbSockSetLastError(pThis, iRet) pThis-&gt;iLastErr = iRet</span>
00107 <span class="preprocessor"></span>
<a name="l00109"></a><a class="code" href="sockets_8h.html#a5">00109</a> <span class="preprocessor">#define sbSockResetLastError(pThis) pThis-&gt;iLastErr = SR_RET_OK</span>
00110 <span class="preprocessor"></span>
00111 
00123 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a1">sbSockLayerInit</a>(<span class="keywordtype">int</span> bInitOSStack);     
00134 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a2">sbSockLayerExit</a>(<span class="keywordtype">int</span> bExitOSStack);
00135 
00136 sbSockObj* <a class="code" href="socketsUnix_8c.html#a2">sbSockInit</a>(<span class="keywordtype">void</span>);    
00137 sbSockObj* <a class="code" href="socketsWin32_8c.html#a4">sbSockInitEx</a>(<span class="keywordtype">int</span> af, <span class="keywordtype">int</span> iSockType); 
00139 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="sockets_8h.html#a17">sbSockExit</a>(sbSockObj*);        
00140 <span class="keywordtype">int</span> <a class="code" href="sockets_8c.html#a2">sbSockGetLastSockError</a>(sbSockObj*); 
00146 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a13">sbSockConnectoToHost</a>(sbSockObj* pThis, <span class="keywordtype">char</span>* pszHost, <span class="keywordtype">int</span> iPort);
00147 
00154 <span class="keywordtype">int</span> <a class="code" href="sockets_8h.html#a20">sbSockHasReceiveData</a>(sbSockObj* pThis);
00155 
00164 <span class="keywordtype">int</span> <a class="code" href="sockets_8h.html#a21">sbSockReceive</a>(sbSockObj* pThis, <span class="keywordtype">char</span> * pszBuf, <span class="keywordtype">int</span> iLen);
00165 
00173 <span class="keywordtype">int</span> <a class="code" href="sockets_8h.html#a22">sbSockSend</a>(sbSockObj* pThis, <span class="keyword">const</span> <span class="keywordtype">char</span>* pszBuf, <span class="keywordtype">int</span> iLen);
00174 
00183 <span class="keywordtype">int</span> <a class="code" href="sockets_8c.html#a4">sbSockGetRcvChar</a>(sbSockObj *pThis);
00184 
00193 <span class="keywordtype">int</span> <a class="code" href="sockets_8c.html#a3">sbSockPeekRcvChar</a>(sbSockObj *pThis);
00194 
00198 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a8">sbSockClosesocket</a>(sbSockObj *pThis);
00199 
00200 
00205 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="sockets_8c.html#a7">sbSockWaitReceiveData</a>(<span class="keyword">struct</span> <a class="code" href="structsbSockObject.html">sbSockObject</a>* pThis);
00206 
<a name="l00210"></a><a class="code" href="sockets_8h.html#a12">00210</a> <span class="keyword">typedef</span> fd_set <a class="code" href="sockets_8h.html#a12">srSock_fd_set</a>;
00211 
<a name="l00218"></a><a class="code" href="sockets_8h.html#a6">00218</a> <span class="preprocessor">#define sbSockFD_ZERO(fdset) FD_ZERO(fdset)</span>
00219 <span class="preprocessor"></span>
<a name="l00225"></a><a class="code" href="sockets_8h.html#a7">00225</a> <span class="preprocessor">#define sbSockFD_SET(sock, fdset) FD_SET(sock, fdset)</span>
00226 <span class="preprocessor"></span>
<a name="l00232"></a><a class="code" href="sockets_8h.html#a8">00232</a> <span class="preprocessor">#define sbSockFD_ISSET(sock, fdset) FD_ISSET(sock, fdset)</span>
00233 <span class="preprocessor"></span>
00234 
00244 <span class="preprocessor">#       ifdef SROS_WIN32</span>
00245 <span class="preprocessor"></span>                <span class="keywordtype">int</span> <a class="code" href="socketsWin32_8c.html#a9">sbSockSelectMulti</a>(srSock_fd_set *fdsetRD, srSock_fd_set *fdsetWR, <span class="keywordtype">int</span> iTimOutSecs, <span class="keywordtype">int</span> iTimOutMSecs);
00246 <span class="preprocessor">#       else</span>
00247 <span class="preprocessor"></span>                <span class="keywordtype">int</span> <a class="code" href="socketsWin32_8c.html#a9">sbSockSelectMulti</a>(srSock_fd_set *fdsetRD, srSock_fd_set *fdsetWR, <span class="keywordtype">int</span> iTimOutSecs, <span class="keywordtype">int</span> iTimOutMSecs, <span class="keywordtype">int</span> iHighestDesc);
00248 <span class="preprocessor">#       endif</span>
00249 <span class="preprocessor"></span>
00253 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a7">sbSockListen</a>(sbSockObj*pThis);
00254 
00276 sbSockObj*      <a class="code" href="sockets_8c.html#a8">sbSockInitListenSock</a>(srRetVal *iRet, <span class="keywordtype">int</span> iType, <span class="keywordtype">char</span> *szBindToAddress, <span class="keywordtype">unsigned</span> uBindToPort);
00277 
00282 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="sockets_8c.html#a9">sbSockAcceptConnection</a>(sbSockObj* pThis, sbSockObj** pNew);
00283 
00287 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a5">sbSockSetNonblocking</a>(sbSockObj*pThis);
00288 
00293 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="sockets_8c.html#a10">sbSockGetRemoteHostIP</a>(sbSockObj *pThis, <span class="keywordtype">char</span> **ppszHost);
00294 
00304 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a16">sbSock_gethostname</a>(<span class="keywordtype">char</span> **psz);
00305 
00325 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="sockets_8c.html#a11">sbSockGetIPusedForSending</a>(sbSockObj* pThis, <span class="keywordtype">char</span>**ppsz);
00326 
00327 
00338 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="sockets_8c.html#a12">sbSockRecvFrom</a>(sbSockObj *pThis, <span class="keywordtype">char</span>* pRecvBuf, <span class="keywordtype">int</span> *piBufLen, <span class="keywordtype">char</span>** ppFrom);
00339 
00340 
00341 <span class="preprocessor">#ifdef SROS_WIN32</span>
00342 <span class="preprocessor"></span><span class="preprocessor">#       define SBSOCK_EWOULDBLOCK WSAEWOULDBLOCK</span>
00343 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00344 <span class="preprocessor"></span><span class="preprocessor">#       define SBSOCK_EWOULDBLOCK EWOULDBLOCK</span>
00345 <span class="preprocessor"></span><span class="preprocessor">#       define SOCKET_ERROR -1</span>
00346 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00347 <span class="preprocessor"></span>
00348 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Oct 3 12:29:55 2005 for liblogging by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.2 </small></address>
</body>
</html>
