<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>liblogging: sockets.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.2 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>sockets.h</h1><a href="sockets_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 
00050 <span class="preprocessor">#ifndef __LIB3195_SOCKETS_H_INCLUDED__</span>
00051 <span class="preprocessor"></span><span class="preprocessor">#define __LIB3195_SOCKETS_H_INCLUDED__ 1</span>
00052 <span class="preprocessor"></span>
00053 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00054 <span class="preprocessor">#ifdef SROS_WIN32</span>
00055 <span class="preprocessor"></span><span class="preprocessor">#  include &lt;winsock2.h&gt;</span>
00056 <span class="preprocessor">#else</span>
00057 <span class="preprocessor"></span><span class="preprocessor">#include &lt;sys/types.h&gt;</span>
00058 <span class="preprocessor">#include &lt;sys/time.h&gt;</span>
00059 <span class="preprocessor">#include &lt;sys/socket.h&gt;</span>
00060 <span class="preprocessor">#include &lt;sys/select.h&gt;</span>
00061 <span class="preprocessor">#include &lt;unistd.h&gt;</span>
00062 <span class="preprocessor">#include &lt;netinet/in.h&gt;</span>
00063 <span class="preprocessor">#include &lt;netdb.h&gt;</span>
00064 <span class="preprocessor">#include &lt;errno.h&gt;</span>
00065 <span class="preprocessor">#endif</span>
00066 <span class="preprocessor"></span>
00067 <span class="preprocessor">#define sbSockCHECKVALIDOBJECT(x) {assert(x != NULL); assert(x-&gt;OID == OIDsbSock);}</span>
00068 <span class="preprocessor"></span>
<a name="l00072"></a><a class="code" href="sockets_8h.html#a2">00072</a> <span class="preprocessor">#define sbSOCK_NO_CHAR -1</span>
00073 <span class="preprocessor"></span>
<a name="l00074"></a><a class="code" href="structsbSockObject.html">00074</a> <span class="keyword">struct </span><a class="code" href="structsbSockObject.html">sbSockObject</a> 
00078 {       
<a name="l00079"></a><a class="code" href="structsbSockObject.html#o0">00079</a>         srObjID <a class="code" href="structsbSockObject.html#o0">OID</a>;            
<a name="l00080"></a><a class="code" href="structsbSockObject.html#o1">00080</a>         <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="structsbSockObject.html#o1">iLastErr</a>;  
<a name="l00081"></a><a class="code" href="structsbSockObject.html#o2">00081</a>         SR_SOCKET <a class="code" href="structsbSockObject.html#o2">sock</a>;         
<a name="l00082"></a><a class="code" href="structsbSockObject.html#o3">00082</a>         <span class="keywordtype">int</span> <a class="code" href="structsbSockObject.html#o3">bIsInError</a>;         
<a name="l00083"></a><a class="code" href="structsbSockObject.html#o4">00083</a>         <span class="keywordtype">int</span>     <a class="code" href="structsbSockObject.html#o4">dwLastError</a>;    
<a name="l00084"></a><a class="code" href="structsbSockObject.html#o5">00084</a>         <span class="keywordtype">char</span> <a class="code" href="structsbSockObject.html#o5">szInBuf</a>[<a class="code" href="config_8h.html#a3">SOCKETMAXINBUFSIZE</a>]; 
<a name="l00085"></a><a class="code" href="structsbSockObject.html#o6">00085</a>         <span class="keywordtype">int</span> <a class="code" href="structsbSockObject.html#o6">iCurInBufPos</a>;       
<a name="l00086"></a><a class="code" href="structsbSockObject.html#o7">00086</a>         <span class="keywordtype">int</span> <a class="code" href="structsbSockObject.html#o7">iInBufLen</a>;          
<a name="l00087"></a><a class="code" href="structsbSockObject.html#o8">00087</a>         fd_set <a class="code" href="structsbSockObject.html#o8">fdset</a>;           
<a name="l00088"></a><a class="code" href="structsbSockObject.html#o9">00088</a>         <span class="keywordtype">char</span> *<a class="code" href="structsbSockObject.html#o9">pRemoteHost</a>;      
00089 };
00090 <span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsbSockObject.html">sbSockObject</a> sbSockObj;
00091 
00092 
00093 <span class="comment">/* The following three macros could also be inline code.</span>
00094 <span class="comment"> * For now, I have kept them to be macros to make </span>
00095 <span class="comment"> * facilitate porting.</span>
00096 <span class="comment"> */</span>
00097 
<a name="l00099"></a><a class="code" href="sockets_8h.html#a3">00099</a> <span class="preprocessor">#define sbSockGetLastError(pThis) pThis-&gt;iLastErr</span>
00100 <span class="preprocessor"></span>
<a name="l00102"></a><a class="code" href="sockets_8h.html#a4">00102</a> <span class="preprocessor">#define sbSockSetLastError(pThis, iRet) pThis-&gt;iLastErr = iRet</span>
00103 <span class="preprocessor"></span>
<a name="l00105"></a><a class="code" href="sockets_8h.html#a5">00105</a> <span class="preprocessor">#define sbSockResetLastError(pThis) pThis-&gt;iLastErr = SR_RET_OK</span>
00106 <span class="preprocessor"></span>
00107 
00119 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a1">sbSockLayerInit</a>(<span class="keywordtype">int</span> bInitOSStack);     
00130 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a2">sbSockLayerExit</a>(<span class="keywordtype">int</span> bExitOSStack);
00131 
00132 sbSockObj* <a class="code" href="socketsUnix_8c.html#a2">sbSockInit</a>(<span class="keywordtype">void</span>);    
00133 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="sockets_8h.html#a16">sbSockExit</a>(sbSockObj*);        
00134 <span class="keywordtype">int</span> <a class="code" href="sockets_8c.html#a2">sbSockGetLastSockError</a>(sbSockObj*); 
00140 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a12">sbSockConnectoToHost</a>(sbSockObj* pThis, <span class="keywordtype">char</span>* pszHost, <span class="keywordtype">int</span> iPort);
00141 
00148 <span class="keywordtype">int</span> <a class="code" href="sockets_8h.html#a19">sbSockHasReceiveData</a>(sbSockObj* pThis);
00149 
00158 <span class="keywordtype">int</span> <a class="code" href="sockets_8h.html#a20">sbSockReceive</a>(sbSockObj* pThis, <span class="keywordtype">char</span> * pszBuf, <span class="keywordtype">int</span> iLen);
00159 
00167 <span class="keywordtype">int</span> <a class="code" href="sockets_8h.html#a21">sbSockSend</a>(sbSockObj* pThis, <span class="keyword">const</span> <span class="keywordtype">char</span>* pszBuf, <span class="keywordtype">int</span> iLen);
00168 
00177 <span class="keywordtype">int</span> <a class="code" href="sockets_8c.html#a4">sbSockGetRcvChar</a>(sbSockObj *pThis);
00178 
00187 <span class="keywordtype">int</span> <a class="code" href="sockets_8c.html#a3">sbSockPeekRcvChar</a>(sbSockObj *pThis);
00188 
00192 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a7">sbSockClosesocket</a>(sbSockObj *pThis);
00193 
00194 
00199 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="sockets_8c.html#a7">sbSockWaitReceiveData</a>(<span class="keyword">struct</span> <a class="code" href="structsbSockObject.html">sbSockObject</a>* pThis);
00200 
<a name="l00204"></a><a class="code" href="sockets_8h.html#a12">00204</a> <span class="keyword">typedef</span> fd_set <a class="code" href="sockets_8h.html#a12">srSock_fd_set</a>;
00205 
<a name="l00212"></a><a class="code" href="sockets_8h.html#a6">00212</a> <span class="preprocessor">#define sbSockFD_ZERO(fdset) FD_ZERO(fdset)</span>
00213 <span class="preprocessor"></span>
<a name="l00219"></a><a class="code" href="sockets_8h.html#a7">00219</a> <span class="preprocessor">#define sbSockFD_SET(sock, fdset) FD_SET(sock, fdset)</span>
00220 <span class="preprocessor"></span>
<a name="l00226"></a><a class="code" href="sockets_8h.html#a8">00226</a> <span class="preprocessor">#define sbSockFD_ISSET(sock, fdset) FD_ISSET(sock, fdset)</span>
00227 <span class="preprocessor"></span>
00228 
00238 <span class="preprocessor">#       ifdef SROS_WIN32</span>
00239 <span class="preprocessor"></span>                <span class="keywordtype">int</span> <a class="code" href="socketsWin32_8c.html#a8">sbSockSelectMulti</a>(srSock_fd_set *fdsetRD, srSock_fd_set *fdsetWR, <span class="keywordtype">int</span> iTimOutSecs, <span class="keywordtype">int</span> iTimOutMSecs);
00240 <span class="preprocessor">#       else</span>
00241 <span class="preprocessor"></span>                <span class="keywordtype">int</span> <a class="code" href="socketsWin32_8c.html#a8">sbSockSelectMulti</a>(srSock_fd_set *fdsetRD, srSock_fd_set *fdsetWR, <span class="keywordtype">int</span> iTimOutSecs, <span class="keywordtype">int</span> iTimOutMSecs, <span class="keywordtype">int</span> iHighestDesc);
00242 <span class="preprocessor">#       endif</span>
00243 <span class="preprocessor"></span>
00247 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a6">sbSockListen</a>(sbSockObj*pThis);
00248 
00268 sbSockObj*      <a class="code" href="sockets_8c.html#a8">sbSockInitListenSock</a>(srRetVal *iRet, <span class="keywordtype">char</span> *szBindToAddress, <span class="keywordtype">unsigned</span> uBindToPort);
00269 
00274 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="sockets_8c.html#a9">sbSockAcceptConnection</a>(sbSockObj* pThis, sbSockObj** pNew);
00275 
00279 <a class="code" href="liblogging_8h.html#a6">srRetVal</a> <a class="code" href="socketsWin32_8c.html#a4">sbSockSetNonblocking</a>(sbSockObj*pThis);
00280 
00281 
00282 <span class="preprocessor">#ifdef SROS_WIN32</span>
00283 <span class="preprocessor"></span><span class="preprocessor">#       define SBSOCK_EWOULDBLOCK WSAEWOULDBLOCK</span>
00284 <span class="preprocessor"></span><span class="preprocessor">#else</span>
00285 <span class="preprocessor"></span><span class="preprocessor">#       define SBSOCK_EWOULDBLOCK EWOULDBLOCK</span>
00286 <span class="preprocessor"></span><span class="preprocessor">#       define SOCKET_ERROR -1</span>
00287 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
00288 <span class="preprocessor"></span>
00289 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Sep 1 10:15:06 2003 for liblogging by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.2 </small></address>
</body>
</html>
